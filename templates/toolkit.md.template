# Claude Toolkit Reference â€” {{PROJECT_NAME}}

This project uses [claude-toolkit](https://github.com/{{TOOLKIT_REPO}}) to manage Claude Code hooks, settings, and conventions.

## File Ownership

### Toolkit-Managed (Do Not Edit Directly)

These files are generated or managed by the toolkit. Changes will be overwritten on update.

| File | Purpose |
| ---- | ------- |
| `.claude/toolkit/hooks/*.sh` | Hook scripts (from toolkit repo) |
| `.claude/toolkit/hooks/_config.sh` | Shared config helper |
| `.claude/toolkit-cache.env` | Generated from `toolkit.toml` |
| `.claude/settings.json` | Generated by `generate-settings.py` |
| `.mcp.json` | Generated MCP server config |

### Project-Owned (You Edit These)

| File | Purpose |
| ---- | ------- |
| `.claude/toolkit.toml` | Project-specific hook configuration |
| `.claude/settings-project.json` | Project-specific settings overlay |
| `.claude/rules/*.md` | Coding convention rules |
| `CLAUDE.md` | Project context document |
| `docs/context/*.md` | Domain context files |

## Configuration

### toolkit.toml

The main configuration file. Controls hook behavior, linters, quality gates, and auto-approve rules.

```bash
# Regenerate cache after editing toolkit.toml:
python3 .claude/toolkit/generate-config-cache.py \
    --toml .claude/toolkit.toml \
    --output .claude/toolkit-cache.env
```

### settings-project.json

Project-specific settings overlay merged on top of toolkit base + stack settings.

```bash
# Regenerate settings.json:
python3 .claude/toolkit/generate-settings.py \
    --base .claude/toolkit/templates/settings-base.json \
    --stacks .claude/toolkit/templates/stacks/python.json \
    --project .claude/settings-project.json \
    --output .claude/settings.json
```

### MCP Servers

MCP servers are configured via base.mcp.json and optional project overrides.

```bash
# Regenerate .mcp.json:
python3 .claude/toolkit/generate-settings.py \
    --base .claude/toolkit/templates/settings-base.json \
    --project .claude/settings-project.json \
    --mcp-base .claude/toolkit/mcp/base.mcp.json \
    --mcp-output .mcp.json \
    --output .claude/settings.json
```

To remove an MCP server, set it to `null` in settings-project.json:

```json
{
  "mcpServers": {
    "playwright": null
  }
}
```

## Updating the Toolkit

```bash
cd .claude/toolkit
git pull origin main
# Regenerate config and settings
```

## Hooks Overview

| Hook | Event | Purpose |
| ---- | ----- | ------- |
| `guard-destructive.sh` | PreToolUse:Bash | Block dangerous shell commands |
| `guard-sensitive-writes.sh` | PreToolUse:Write/Edit | Block writes to sensitive files |
| `setup.sh` | SessionStart:startup | Validate development environment |
| `session-start.sh` | SessionStart:startup/resume/clear | Load project context |
| `post-compact-reinject.sh` | SessionStart:compact | Re-inject context after compaction |
| `pre-compact.sh` | PreCompact | Save state before compaction |
| `smart-context.py` | UserPromptSubmit | Load domain-specific context |
| `post-edit-lint.sh` | PostToolUse:Write/Edit | Async lint on modified files |
| `classify-error.sh` | PostToolUseFailure | Classify and categorize errors |
| `task-completed-gate.sh` | TaskCompleted | Quality gates before completion |
| `subagent-context-inject.sh` | SubagentStart | Inject context into subagents |
| `subagent-quality-gate.sh` | SubagentStop | Validate subagent output |
| `verify-completion.sh` | Stop | Check for uncommitted changes |
| `session-end-cleanup.sh` | SessionEnd | Clean up session files |
| `auto-approve-safe.sh` | PermissionRequest | Auto-approve safe operations |
| `notify.sh` | Notification | macOS/Linux notifications |
